<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Gin 相关的一点 | SimulatedSakura</title><meta name="description" content="​    回看煎鱼佬的博客和 topgoer 的 gin 文档，发现带着做的博客项目用到的内容确实不少，使用了不少的其他辅助包来协助开发，但是基本上都只是在使用层面，确实也很容遗忘掉，所以这两天重看了下博客，在这里就整理下在下面文档中提到的关于 Gin 的基础知识 简介与安装​    没什么可讲的，Gin 是一个 Web 框架，特点是封装比较优雅，API友好，源码注释比较明确，具有快速灵活，容错方"><meta name="keywords" content="笔记,Gin 框架,基础"><meta name="author" content="SimulatedSakura"><meta name="copyright" content="SimulatedSakura"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://yoursite.com/posts/59208/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><meta property="og:type" content="article"><meta property="og:title" content="Gin 相关的一点"><meta property="og:url" content="http://yoursite.com/posts/59208/"><meta property="og:site_name" content="SimulatedSakura"><meta property="og:description" content="​    回看煎鱼佬的博客和 topgoer 的 gin 文档，发现带着做的博客项目用到的内容确实不少，使用了不少的其他辅助包来协助开发，但是基本上都只是在使用层面，确实也很容遗忘掉，所以这两天重看了下博客，在这里就整理下在下面文档中提到的关于 Gin 的基础知识 简介与安装​    没什么可讲的，Gin 是一个 Web 框架，特点是封装比较优雅，API友好，源码注释比较明确，具有快速灵活，容错方"><meta property="og:image" content="https://s2.loli.net/2022/09/10/vVYzpIRW4uwioGZ.png"><meta property="article:published_time" content="2022-09-12T04:18:15.000Z"><meta property="article:modified_time" content="2022-09-12T08:41:00.399Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="next" title="阶段性总结" href="http://yoursite.com/posts/41505/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: true,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2022-09-12 16:41:00'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@master/Hexo/css/flink.min.css"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://s2.loli.net/2022/08/23/L8w9ATnFKUIYgCH.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">8</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">11</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 媒体</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/bangumis/"><i class="fa-fw fab fa-youtube"></i><span> 番剧</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书单</span></a></li><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/box/"><i class="fa-fw fab fa-xbox"></i><span> 聚宝盒</span></a></div><div class="menus_item"><a class="site-page" href="/talk/"><i class="fa-fw far fa-comment"></i><span> 微语</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw far fa-image"></i><span> 相册</span></a></li><li><a class="site-page" href="/home/"><i class="fa-fw fab fa-phoenix-framework"></i><span> 主页</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/contact/"><i class="fa-fw far fa-comments"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#简介与安装"><span class="toc-number">1.</span> <span class="toc-text">简介与安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Restful-风格的-API"><span class="toc-number">2.</span> <span class="toc-text">Restful 风格的 API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#API参数和URL参数"><span class="toc-number">3.</span> <span class="toc-text">API参数和URL参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#表单参数"><span class="toc-number">4.</span> <span class="toc-text">表单参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#文件上传"><span class="toc-number">5.</span> <span class="toc-text">文件上传</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#routes-group"><span class="toc-number">6.</span> <span class="toc-text">routes group</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#路由原理"><span class="toc-number">7.</span> <span class="toc-text">路由原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#路由拆分与注册"><span class="toc-number">8.</span> <span class="toc-text">路由拆分与注册</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gin-数据解析与绑定"><span class="toc-number">9.</span> <span class="toc-text">Gin 数据解析与绑定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gin-渲染"><span class="toc-number">10.</span> <span class="toc-text">Gin 渲染</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#各种数据格式的响应"><span class="toc-number">10.1.</span> <span class="toc-text">各种数据格式的响应</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#重定向"><span class="toc-number">10.2.</span> <span class="toc-text">重定向</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#同步异步"><span class="toc-number">10.3.</span> <span class="toc-text">同步异步</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Gin-中间件"><span class="toc-number">11.</span> <span class="toc-text">Gin 中间件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#会话控制"><span class="toc-number">12.</span> <span class="toc-text">会话控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie介绍"><span class="toc-number">12.1.</span> <span class="toc-text">Cookie介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie的使用"><span class="toc-number">12.2.</span> <span class="toc-text">Cookie的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Sessions"><span class="toc-number">12.3.</span> <span class="toc-text">Sessions</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参数验证"><span class="toc-number">13.</span> <span class="toc-text">参数验证</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#结构体验证"><span class="toc-number">13.1.</span> <span class="toc-text">结构体验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#beego-validation"><span class="toc-number">13.2.</span> <span class="toc-text">beego&#x2F;validation</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><header class="post-bg" id="page-header" style="background-image: url(https://s2.loli.net/2022/09/10/vVYzpIRW4uwioGZ.png)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">SimulatedSakura</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fas fa-list"></i><span> 媒体</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/bangumis/"><i class="fa-fw fab fa-youtube"></i><span> 番剧</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书单</span></a></li><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/box/"><i class="fa-fw fab fa-xbox"></i><span> 聚宝盒</span></a></div><div class="menus_item"><a class="site-page" href="/talk/"><i class="fa-fw far fa-comment"></i><span> 微语</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down menus-expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw far fa-image"></i><span> 相册</span></a></li><li><a class="site-page" href="/home/"><i class="fa-fw fab fa-phoenix-framework"></i><span> 主页</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/contact/"><i class="fa-fw far fa-comments"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Gin 相关的一点</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2022-09-12 12:18:15"><i class="far fa-calendar-alt fa-fw"></i> 发表于 2022-09-12</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2022-09-12 16:41:00"><i class="fas fa-history fa-fw"></i> 更新于 2022-09-12</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/blog/">blog</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p>​    回看煎鱼佬的博客和 topgoer 的 gin 文档，发现带着做的博客项目用到的内容确实不少，使用了不少的其他辅助包来协助开发，但是基本上都只是在使用层面，确实也很容遗忘掉，所以这两天重看了下博客，在这里就整理下在下面文档中提到的关于 Gin 的基础知识</p>
<h2 id="简介与安装"><a href="#简介与安装" class="headerlink" title="简介与安装"></a>简介与安装</h2><p>​    没什么可讲的，Gin 是一个 Web 框架，特点是封装比较优雅，API友好，源码注释比较明确，具有快速灵活，容错方便，安装的话使用go get来获取即可</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go get -u github.com/gin-gonic/gin</span><br></pre></td></tr></table></figure>

<h2 id="Restful-风格的-API"><a href="#Restful-风格的-API" class="headerlink" title="Restful 风格的 API"></a>Restful 风格的 API</h2><ul>
<li>gin支持Restful风格的API</li>
<li>即 Representational State Transfer 的缩写。直接翻译的意思是”表现层状态转化”，是一种互联网应用程序的API设计理念：URL定位资源，用HTTP描述操作</li>
</ul>
<p>简单来说就是要合理使用HTTP Method来执行操作，并将响应码放到对应的 Response Code 下面两个表会有所帮助：</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>介绍</th>
<th>幂等</th>
</tr>
</thead>
<tbody><tr>
<td>GET</td>
<td>数据的查询操作</td>
<td>Yes</td>
</tr>
<tr>
<td>HEAD</td>
<td>与<code>GET</code>相同, 区别是响应中不包含响应体. 可以用来获取资源的元数据, 如 header 等</td>
<td>Yes</td>
</tr>
<tr>
<td>POST</td>
<td>信息的创建 有意思的是, 创建成功应该返回响应码 201</td>
<td>No</td>
</tr>
<tr>
<td>PATCH</td>
<td>用于局部更新 从 POST 请求分出来的, POST 全量更新, PATCH 局部更新. <a href="https://www.rfc-editor.org/rfc/rfc5789" target="_blank" rel="noopener">文档地址</a></td>
<td>No</td>
</tr>
<tr>
<td>PUT</td>
<td>信息的更新</td>
<td>Yes</td>
</tr>
<tr>
<td>DELETE</td>
<td>数据删除</td>
<td>Yes</td>
</tr>
<tr>
<td>OPTIONS</td>
<td>API 相关信息 如探测服务支持的所有<code>Method</code>, 或者检测服务通不通.</td>
<td>Yes</td>
</tr>
<tr>
<td>CONNECTED</td>
<td>与服务器建立链接, 通过服务器代理客户端请求 说白了就是一个 HTTP 代理</td>
<td>Yes</td>
</tr>
<tr>
<td>TRACE</td>
<td>对请求路径的环回测试</td>
<td>Yes</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>响应码</th>
<th>介绍</th>
</tr>
</thead>
<tbody><tr>
<td>1xx</td>
<td>请求已收到, 需要继续操作</td>
</tr>
<tr>
<td>2xx</td>
<td>请求成功处理</td>
</tr>
<tr>
<td>3xx</td>
<td>重定向, 需要进一步请求</td>
</tr>
<tr>
<td>4xx</td>
<td>客户端错误</td>
</tr>
<tr>
<td>5xx</td>
<td>服务器错误</td>
</tr>
</tbody></table>
<h2 id="API参数和URL参数"><a href="#API参数和URL参数" class="headerlink" title="API参数和URL参数"></a>API参数和URL参数</h2><p>API 参数可以通过 Context 的 Param(“参数名”) 方法来获取</p>
<p>URL 参数可以通过 DefaultQuery(“参数名”，“默认值”) 或 Query(“参数名”) 方法获取</p>
<p>具体到一个 URL 链接上，可以以下面这个为例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;abc.xyz&#x2F;action&#x2F;users&#x2F;1?username&#x3D;xx&amp;password&#x3D;yy</span><br><span class="line">假设是以POST方式定义的接口为api.POST(&quot;&#x2F;users&#x2F;:id&quot;)</span><br><span class="line">那么很明显我们可以通过c.Param(&quot;id&quot;) 来得到 1</span><br><span class="line">通过 c.DefaultQuery(“username”,&quot;xyz&quot;) 来得到 xx</span><br><span class="line">通过 c.Query(“password”) 来得到 yy</span><br><span class="line">通过 c.DefaultQuery(“Address”,&quot;127.0.0.1&quot;) 来得到 127.0.0.1</span><br></pre></td></tr></table></figure>



<h2 id="表单参数"><a href="#表单参数" class="headerlink" title="表单参数"></a>表单参数</h2><p>这是一个在搭建博客API中没有用到的知识点，其实内容也没什么</p>
<ul>
<li>首先，表单传输是以POST的方式进行的，http的常见传输方式有4种：<ul>
<li>application/json</li>
<li>application/x-www-form-urlencoded</li>
<li>application/xml</li>
<li>multipart/form-data</li>
</ul>
</li>
<li>而后，表单参数可以通过 PostForm() 方法获取，同样的该方法也有配套的 DefaultPostForm() 方法，具体的用法和 URL 传参没有大的区别，该方法默认解析的是 x-www-form-urlencoded 或 from-data 格式的参数</li>
</ul>
<h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><p>暂时没有用到，不过挺简单的，同样是通过POST方法，提到了几个方法可以了解下</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">     r := gin.Default()</span><br><span class="line">    <span class="comment">//限制上传最大尺寸</span></span><br><span class="line">    r.MaxMultipartMemory = <span class="number">8</span> &lt;&lt; <span class="number">20</span></span><br><span class="line">    r.POST(<span class="string">"/upload"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        <span class="comment">//似乎就是通过这个方法获得了单个的文件，那么多个文件也就显然</span></span><br><span class="line">        <span class="comment">//但加了个判断多重窗口的问题，就放在下面了</span></span><br><span class="line">        file, err := c.FormFile(<span class="string">"file"</span>) </span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            c.String(<span class="number">500</span>, <span class="string">"上传图片出错"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// c.JSON(200, gin.H&#123;"message": file.Header.Context&#125;)</span></span><br><span class="line">        c.SaveUploadedFile(file, file.Filename)</span><br><span class="line">        c.String(http.StatusOK, file.Filename)</span><br><span class="line">    &#125;)</span><br><span class="line">    r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="comment">// 1.创建路由</span></span><br><span class="line">   <span class="comment">// 默认使用了2个中间件Logger(), Recovery()</span></span><br><span class="line">   r := gin.Default()</span><br><span class="line">   <span class="comment">// 限制表单上传大小 8MB，默认为32MB</span></span><br><span class="line">   r.MaxMultipartMemory = <span class="number">8</span> &lt;&lt; <span class="number">20</span></span><br><span class="line">   r.POST(<span class="string">"/upload"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">      form, err := c.MultipartForm()</span><br><span class="line">      <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">         c.String(http.StatusBadRequest, fmt.Sprintf(<span class="string">"get err %s"</span>, err.Error()))</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 获取所有图片</span></span><br><span class="line">      files := form.File[<span class="string">"files"</span>]</span><br><span class="line">      <span class="comment">// 遍历所有图片</span></span><br><span class="line">      <span class="keyword">for</span> _, file := <span class="keyword">range</span> files &#123;</span><br><span class="line">         <span class="comment">// 逐个存</span></span><br><span class="line">         <span class="keyword">if</span> err := c.SaveUploadedFile(file, file.Filename); err != <span class="literal">nil</span> &#123;</span><br><span class="line">            c.String(http.StatusBadRequest, fmt.Sprintf(<span class="string">"upload err %s"</span>, err.Error()))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      c.String(<span class="number">200</span>, fmt.Sprintf(<span class="string">"upload ok %d files"</span>, <span class="built_in">len</span>(files)))</span><br><span class="line">   &#125;)</span><br><span class="line">   <span class="comment">//默认端口号是8080</span></span><br><span class="line">   r.Run(<span class="string">":8000"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="routes-group"><a href="#routes-group" class="headerlink" title="routes group"></a>routes group</h2><p>用过，没啥好说的，个人就是将 API 进行了分类，或者说是为了管理一些相同的URL</p>
<p>举个例子</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">v1 := r.Group(<span class="string">"/v1"</span>)</span><br><span class="line">&#123;</span><br><span class="line">    v1.POST(<span class="string">"/login"</span>, login)</span><br><span class="line">&#125;</span><br><span class="line">v2 := r.Group(<span class="string">"/v2"</span>)</span><br><span class="line">&#123;</span><br><span class="line">    v2.POST(<span class="string">"/login"</span>, login)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//访问链接分别为xxx/v1/login 和 xxx/v2/login 是完全不同的两组接口</span></span><br></pre></td></tr></table></figure>

<h2 id="路由原理"><a href="#路由原理" class="headerlink" title="路由原理"></a>路由原理</h2><p>一颗树，没毛病</p>
<h2 id="路由拆分与注册"><a href="#路由拆分与注册" class="headerlink" title="路由拆分与注册"></a>路由拆分与注册</h2><p>煎鱼的博客API做的已经是比较规范了的,不如去 routers 包下看看怎么做的路由拆分</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">go-gin-example/</span><br><span class="line">├── conf</span><br><span class="line">│   └── app.ini</span><br><span class="line">├── main.go</span><br><span class="line">├── middleware</span><br><span class="line">├── models</span><br><span class="line">│   ├── article.go</span><br><span class="line">│   ├── models.go</span><br><span class="line">│   └── tag.go</span><br><span class="line">├── pkg</span><br><span class="line">│   ├── e</span><br><span class="line">│   │   ├── code.go</span><br><span class="line">│   │   └── msg.go</span><br><span class="line">│   ├── setting</span><br><span class="line">│   │   └── setting.go</span><br><span class="line">│   └── util</span><br><span class="line">│       └── pagination.go</span><br><span class="line">├── routers</span><br><span class="line">│   ├── api</span><br><span class="line">│   │   └── v1</span><br><span class="line">│   │       ├── article.go</span><br><span class="line">│   │       └── tag.go</span><br><span class="line">│   └── router.go</span><br><span class="line">├── runtime</span><br></pre></td></tr></table></figure>



<h2 id="Gin-数据解析与绑定"><a href="#Gin-数据解析与绑定" class="headerlink" title="Gin 数据解析与绑定"></a>Gin 数据解析与绑定</h2><p>​    基本上是傻瓜式的操作，只需要通过在结构体的字段后面加上结构体标签就行了，具体可以见代码，当然其底层是通过 Go 语言的 reflect 机制实现的，可以看看之前的 Go 语言基础学习笔记，稍微多点字</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"net/http"</span></span><br><span class="line"></span><br><span class="line">    <span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义接收数据的结构体</span></span><br><span class="line"><span class="keyword">type</span> Login <span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="comment">// binding:"required"修饰的字段，若接收为空值，则报错，是必须字段</span></span><br><span class="line">    User    <span class="keyword">string</span> <span class="string">`form:"username" json:"user" uri:"user" xml:"user" binding:"required"`</span></span><br><span class="line">    Pssword <span class="keyword">string</span> <span class="string">`form:"password" json:"password" uri:"password" xml:"password" binding:"required"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 1.创建路由</span></span><br><span class="line">    <span class="comment">// 默认使用了2个中间件Logger(), Recovery()</span></span><br><span class="line">    r := gin.Default()</span><br><span class="line">    <span class="comment">// JSON绑定</span></span><br><span class="line">    r.GET(<span class="string">"/:user/:password"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        <span class="comment">// 声明接收的变量</span></span><br><span class="line">        <span class="keyword">var</span> login Login</span><br><span class="line">        <span class="comment">// Bind()默认解析并绑定form格式</span></span><br><span class="line">        <span class="comment">// 根据请求头中content-type自动推断</span></span><br><span class="line">        <span class="keyword">if</span> err := c.ShouldBindUri(&amp;login); err != <span class="literal">nil</span> &#123;</span><br><span class="line">            c.JSON(http.StatusBadRequest, gin.H&#123;<span class="string">"error"</span>: err.Error()&#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 判断用户名密码是否正确</span></span><br><span class="line">        <span class="keyword">if</span> login.User != <span class="string">"root"</span> || login.Pssword != <span class="string">"admin"</span> &#123;</span><br><span class="line">            c.JSON(http.StatusBadRequest, gin.H&#123;<span class="string">"status"</span>: <span class="string">"304"</span>&#125;)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        c.JSON(http.StatusOK, gin.H&#123;<span class="string">"status"</span>: <span class="string">"200"</span>&#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    r.Run(<span class="string">":8000"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Gin-渲染"><a href="#Gin-渲染" class="headerlink" title="Gin 渲染"></a>Gin 渲染</h2><p>其实不太理解啥叫做渲染，粗略的认识大概就是将数据写到页面上去吧</p>
<h3 id="各种数据格式的响应"><a href="#各种数据格式的响应" class="headerlink" title="各种数据格式的响应"></a>各种数据格式的响应</h3><ul>
<li>json、结构体、XML、YAML类似于java的properties、ProtoBuf</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line">    <span class="string">"github.com/gin-gonic/gin/testdata/protoexample"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 多种响应方式</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 1.创建路由</span></span><br><span class="line">    <span class="comment">// 默认使用了2个中间件Logger(), Recovery()</span></span><br><span class="line">    r := gin.Default()</span><br><span class="line">    <span class="comment">// 1.json</span></span><br><span class="line">    r.GET(<span class="string">"/someJSON"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        c.JSON(<span class="number">200</span>, gin.H&#123;<span class="string">"message"</span>: <span class="string">"someJSON"</span>, <span class="string">"status"</span>: <span class="number">200</span>&#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 2. 结构体响应</span></span><br><span class="line">    r.GET(<span class="string">"/someStruct"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        <span class="keyword">var</span> msg <span class="keyword">struct</span> &#123;</span><br><span class="line">            Name    <span class="keyword">string</span></span><br><span class="line">            Message <span class="keyword">string</span></span><br><span class="line">            Number  <span class="keyword">int</span></span><br><span class="line">        &#125;</span><br><span class="line">        msg.Name = <span class="string">"root"</span></span><br><span class="line">        msg.Message = <span class="string">"message"</span></span><br><span class="line">        msg.Number = <span class="number">123</span></span><br><span class="line">        c.JSON(<span class="number">200</span>, msg)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 3.XML</span></span><br><span class="line">    r.GET(<span class="string">"/someXML"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        c.XML(<span class="number">200</span>, gin.H&#123;<span class="string">"message"</span>: <span class="string">"abc"</span>&#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 4.YAML响应</span></span><br><span class="line">    r.GET(<span class="string">"/someYAML"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        c.YAML(<span class="number">200</span>, gin.H&#123;<span class="string">"name"</span>: <span class="string">"zhangsan"</span>&#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 5.protobuf格式,谷歌开发的高效存储读取的工具</span></span><br><span class="line">    <span class="comment">// 数组？切片？如果自己构建一个传输格式，应该是什么格式？</span></span><br><span class="line">    r.GET(<span class="string">"/someProtoBuf"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        reps := []<span class="keyword">int64</span>&#123;<span class="keyword">int64</span>(<span class="number">1</span>), <span class="keyword">int64</span>(<span class="number">2</span>)&#125;</span><br><span class="line">        <span class="comment">// 定义数据</span></span><br><span class="line">        label := <span class="string">"label"</span></span><br><span class="line">        <span class="comment">// 传protobuf格式数据</span></span><br><span class="line">        data := &amp;protoexample.Test&#123;</span><br><span class="line">            Label: &amp;label,</span><br><span class="line">            Reps:  reps,</span><br><span class="line">        &#125;</span><br><span class="line">        c.ProtoBuf(<span class="number">200</span>, data)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    r.Run(<span class="string">":8000"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h3><p>​    一个小方法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line">    r.GET(<span class="string">"/index"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        c.Redirect(http.StatusMovedPermanently, <span class="string">"http://www.5lmh.com"</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="同步异步"><a href="#同步异步" class="headerlink" title="同步异步"></a>同步异步</h3><p>​    其实就是开个协程？</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 1.创建路由</span></span><br><span class="line">    <span class="comment">// 默认使用了2个中间件Logger(), Recovery()</span></span><br><span class="line">    r := gin.Default()</span><br><span class="line">    <span class="comment">// 1.异步</span></span><br><span class="line">    r.GET(<span class="string">"/long_async"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        <span class="comment">// 需要搞一个副本</span></span><br><span class="line">        copyContext := c.Copy()</span><br><span class="line">        <span class="comment">// 异步处理</span></span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">            time.Sleep(<span class="number">3</span> * time.Second)</span><br><span class="line">            log.Println(<span class="string">"异步执行："</span> + copyContext.Request.URL.Path)</span><br><span class="line">        &#125;()</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 2.同步</span></span><br><span class="line">    r.GET(<span class="string">"/long_sync"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        time.Sleep(<span class="number">3</span> * time.Second)</span><br><span class="line">        log.Println(<span class="string">"同步执行："</span> + c.Request.URL.Path)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    r.Run(<span class="string">":8000"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Gin-中间件"><a href="#Gin-中间件" class="headerlink" title="Gin 中间件"></a>Gin 中间件</h2><p>这部分建议直接看 jwt 验证的代码</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> jwt</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"net/http"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"github.com/SimulatedSakura/go-gin-example/pkg/e"</span></span><br><span class="line">	<span class="string">"github.com/SimulatedSakura/go-gin-example/pkg/util"</span></span><br><span class="line">	<span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">JWT</span><span class="params">()</span> <span class="title">gin</span>.<span class="title">HandlerFunc</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> code <span class="keyword">int</span></span><br><span class="line">		<span class="keyword">var</span> data <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">		code = e.SUCCESS</span><br><span class="line">		token := c.Query(<span class="string">"token"</span>)</span><br><span class="line">		<span class="keyword">if</span> token == <span class="string">""</span> &#123;</span><br><span class="line">			code = e.INVALID_PARAMS</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			claims, err := util.ParseToken(token)</span><br><span class="line">			<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">				code = e.ERROR_AUTH_CHECK_TOKEN_FAIL</span><br><span class="line">				<span class="comment">//如果当前的token过期</span></span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> time.Now().Unix() &gt; claims.ExpiresAt &#123;</span><br><span class="line">				code = e.ERROR_AUTH_CHECK_TOKEN_TIMEOUT</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> code != e.SUCCESS &#123;</span><br><span class="line">			c.JSON(http.StatusUnauthorized, gin.H&#123;</span><br><span class="line">				<span class="string">"code"</span>: code,</span><br><span class="line">				<span class="string">"msg"</span>:  e.GetMsg(code),</span><br><span class="line">				<span class="string">"data"</span>: data,</span><br><span class="line">			&#125;)</span><br><span class="line">			<span class="comment">/*</span></span><br><span class="line"><span class="comment">				洋文:</span></span><br><span class="line"><span class="comment">				Abort prevents pending handlers from being called.</span></span><br><span class="line"><span class="comment">				Note that this will not stop the current handler.</span></span><br><span class="line"><span class="comment">				Let's say you have an authorization middleware that validates that the current request is authorized.</span></span><br><span class="line"><span class="comment">				If the authorization fails (ex: the password does not match), call Abort to ensure the remaining handlers for this request are not called.</span></span><br><span class="line"><span class="comment">				我以为的:</span></span><br><span class="line"><span class="comment">				Abort 在被调用的函数中阻止挂起函数。</span></span><br><span class="line"><span class="comment">				注意这将不会停止当前的函数。</span></span><br><span class="line"><span class="comment">				例如，你有一个验证当前的请求是否是认证过的 Authorization 中间件。</span></span><br><span class="line"><span class="comment">				如果验证失败(例如，密码不匹配)，调用 Abort 以确保这个请求的其他函数不会被调用。</span></span><br><span class="line"><span class="comment">			*/</span></span><br><span class="line"></span><br><span class="line">			c.Abort()</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">			洋文:</span></span><br><span class="line"><span class="comment">			Next should be used only inside middleware.</span></span><br><span class="line"><span class="comment">			It executes the pending handlers in the chain inside the calling handler.</span></span><br><span class="line"><span class="comment">			我以为的:</span></span><br><span class="line"><span class="comment">			Next 应该仅可以在中间件中使用，它在调用的函数中的链中执行挂起的函数;</span></span><br><span class="line"><span class="comment">		*/</span></span><br><span class="line">		c.Next()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用：没啥好说的 r.Use(MiddleWare()) 即可</p>
<h2 id="会话控制"><a href="#会话控制" class="headerlink" title="会话控制"></a>会话控制</h2><h3 id="Cookie介绍"><a href="#Cookie介绍" class="headerlink" title="Cookie介绍"></a>Cookie介绍</h3><ul>
<li>HTTP是无状态协议，服务器不能记录浏览器的访问状态，也就是说服务器不能区分两次请求是否由同一个客户端发出</li>
<li>Cookie就是解决HTTP协议无状态的方案之一，中文是小甜饼的意思</li>
<li>Cookie实际上就是服务器保存在浏览器上的一段信息。浏览器有了Cookie之后，每次向服务器发送请求时都会同时将该信息发送给服务器，服务器收到请求后，就可以根据该信息处理请求</li>
<li>Cookie由服务器创建，并发送给浏览器，最终由浏览器保存</li>
</ul>
<h3 id="Cookie的使用"><a href="#Cookie的使用" class="headerlink" title="Cookie的使用"></a>Cookie的使用</h3><ul>
<li>测试服务端发送cookie给客户端，客户端请求时携带cookie</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">ackage main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">   <span class="string">"github.com/gin-gonic/gin"</span></span><br><span class="line">   <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">   <span class="comment">// 1.创建路由</span></span><br><span class="line">   <span class="comment">// 默认使用了2个中间件Logger(), Recovery()</span></span><br><span class="line">   r := gin.Default()</span><br><span class="line">   <span class="comment">// 服务端要给客户端cookie</span></span><br><span class="line">   r.GET(<span class="string">"cookie"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">      <span class="comment">// 获取客户端是否携带cookie</span></span><br><span class="line">      cookie, err := c.Cookie(<span class="string">"key_cookie"</span>)</span><br><span class="line">      <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">         cookie = <span class="string">"NotSet"</span></span><br><span class="line">         <span class="comment">// 给客户端设置cookie</span></span><br><span class="line">         <span class="comment">//  maxAge int, 单位为秒</span></span><br><span class="line">         <span class="comment">// path,cookie所在目录</span></span><br><span class="line">         <span class="comment">// domain string,域名</span></span><br><span class="line">         <span class="comment">//   secure 是否智能通过https访问</span></span><br><span class="line">         <span class="comment">// httpOnly bool  是否允许别人通过js获取自己的cookie</span></span><br><span class="line">         c.SetCookie(<span class="string">"key_cookie"</span>, <span class="string">"value_cookie"</span>, <span class="number">60</span>, <span class="string">"/"</span>,</span><br><span class="line">            <span class="string">"localhost"</span>, <span class="literal">false</span>, <span class="literal">true</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      fmt.Printf(<span class="string">"cookie的值是： %s\n"</span>, cookie)</span><br><span class="line">   &#125;)</span><br><span class="line">   r.Run(<span class="string">":8000"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Sessions"><a href="#Sessions" class="headerlink" title="Sessions"></a>Sessions</h3><p>但是我们都知道cookie是有缺点的，总结下来就以下几点</p>
<ul>
<li>不安全，明文</li>
<li>增加带宽消耗</li>
<li>可以被禁用</li>
<li>cookie有上限</li>
</ul>
<p>为了解决这些问题，我们引出Sessions来</p>
<p>gorilla/sessions为自定义session后端提供cookie和文件系统session以及基础结构。</p>
<p>主要功能是：</p>
<ul>
<li>简单的API：将其用作设置签名（以及可选的加密）cookie的简便方法。</li>
<li>内置的后端可将session存储在cookie或文件系统中。</li>
<li>Flash消息：一直持续读取的session值。</li>
<li>切换session持久性（又称“记住我”）和设置其他属性的便捷方法。</li>
<li>旋转身份验证和加密密钥的机制。</li>
<li>每个请求有多个session，即使使用不同的后端也是如此。</li>
<li>自定义session后端的接口和基础结构：可以使用通用API检索并批量保存来自不同商店的session。</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"net/http"</span></span><br><span class="line"></span><br><span class="line">    <span class="string">"github.com/gorilla/sessions"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化一个cookie存储对象</span></span><br><span class="line"><span class="comment">// something-very-secret应该是一个你自己的密匙，只要不被别人知道就行</span></span><br><span class="line"><span class="keyword">var</span> store = sessions.NewCookieStore([]<span class="keyword">byte</span>(<span class="string">"something-very-secret"</span>))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    http.HandleFunc(<span class="string">"/save"</span>, SaveSession)</span><br><span class="line">    http.HandleFunc(<span class="string">"/get"</span>, GetSession)</span><br><span class="line">    err := http.ListenAndServe(<span class="string">":8080"</span>, <span class="literal">nil</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"HTTP server failed,err:"</span>, err)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SaveSession</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">    <span class="comment">// Get a session. We're ignoring the error resulted from decoding an</span></span><br><span class="line">    <span class="comment">// existing session: Get() always returns a session, even if empty.</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//　获取一个session对象，session-name是session的名字</span></span><br><span class="line">    session, err := store.Get(r, <span class="string">"session-name"</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        http.Error(w, err.Error(), http.StatusInternalServerError)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 在session中存储值</span></span><br><span class="line">    session.Values[<span class="string">"foo"</span>] = <span class="string">"bar"</span></span><br><span class="line">    session.Values[<span class="number">42</span>] = <span class="number">43</span></span><br><span class="line">    <span class="comment">// 保存更改</span></span><br><span class="line">    session.Save(r, w)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetSession</span><span class="params">(w http.ResponseWriter, r *http.Request)</span></span> &#123;</span><br><span class="line">    session, err := store.Get(r, <span class="string">"session-name"</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        http.Error(w, err.Error(), http.StatusInternalServerError)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    foo := session.Values[<span class="string">"foo"</span>]</span><br><span class="line">    fmt.Println(foo)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>删除session的值可以通过设置过期时间来完成</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除</span></span><br><span class="line"><span class="comment">// 将session的最大存储时间设置为小于零的数即为删除</span></span><br><span class="line">session.Options.MaxAge = <span class="number">-1</span></span><br><span class="line">session.Save(r, w)</span><br></pre></td></tr></table></figure>

<h2 id="参数验证"><a href="#参数验证" class="headerlink" title="参数验证"></a>参数验证</h2><h3 id="结构体验证"><a href="#结构体验证" class="headerlink" title="结构体验证"></a>结构体验证</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Person ..</span></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">    <span class="comment">//不能为空并且大于10</span></span><br><span class="line">    Age      <span class="keyword">int</span>       <span class="string">`form:"age" binding:"required,gt=10"`</span></span><br><span class="line">    Name     <span class="keyword">string</span>    <span class="string">`form:"name" binding:"required"`</span></span><br><span class="line">    Birthday time.Time <span class="string">`form:"birthday" time_format:"2006-01-02" time_utc:"1"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line">    r.GET(<span class="string">"/5lmh"</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        <span class="keyword">var</span> person Person</span><br><span class="line">        <span class="keyword">if</span> err := c.ShouldBind(&amp;person); err != <span class="literal">nil</span> &#123;</span><br><span class="line">            c.String(<span class="number">500</span>, fmt.Sprint(err))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        c.String(<span class="number">200</span>, fmt.Sprintf(<span class="string">"%#v"</span>, person))</span><br><span class="line">    &#125;)</span><br><span class="line">    r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="beego-validation"><a href="#beego-validation" class="headerlink" title="beego/validation"></a>beego/validation</h3><p>煎鱼的博客中使用的用于验证的方法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> auth <span class="keyword">struct</span> &#123;</span><br><span class="line">	Username <span class="keyword">string</span> <span class="string">`valid:"Required;MaxSize(50)"`</span></span><br><span class="line">	Password <span class="keyword">string</span> <span class="string">`valid:"Required;MaxSize(50)"`</span></span><br><span class="line">&#125;</span><br><span class="line">......</span><br><span class="line">username := c.Query(<span class="string">"username"</span>)</span><br><span class="line">	password := c.Query(<span class="string">"password"</span>)</span><br><span class="line">a := auth&#123;</span><br><span class="line">    Username: username,</span><br><span class="line">    Password: password,</span><br><span class="line">&#125;</span><br><span class="line">ok, _ := valid.Valid(&amp;a)</span><br><span class="line">=====================================</span><br><span class="line"><span class="comment">//其他的一些用法</span></span><br><span class="line">valid.Range(state, <span class="number">0</span>, <span class="number">1</span>, <span class="string">"state"</span>).Message(<span class="string">"状态只能为0或者1"</span>)</span><br><span class="line">valid.Min(tagId, <span class="number">1</span>, <span class="string">"tag_id"</span>).Message(<span class="string">"标签ID必须大于0"</span>)</span><br><span class="line">valid.Required(content, <span class="string">"content"</span>).Message(<span class="string">"内容不能为空"</span>)</span><br></pre></td></tr></table></figure>

</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">SimulatedSakura</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/posts/59208/">http://yoursite.com/posts/59208/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">SimulatedSakura</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a><a class="post-meta__tags" href="/tags/Gin-%E6%A1%86%E6%9E%B6/">Gin 框架</a><a class="post-meta__tags" href="/tags/%E5%9F%BA%E7%A1%80/">基础</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2022/09/10/vVYzpIRW4uwioGZ.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/posts/41505/"><img class="next-cover" data-src="https://s2.loli.net/2022/09/10/s86OSoyDzRVqecH.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">阶段性总结</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/posts/1699/" title="Vim 相关"><img class="relatedPosts_cover" data-src="https://s2.loli.net/2022/09/10/GgHnyoxVXWrEkhL.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-31</div><div class="relatedPosts_title">Vim 相关</div></div></a></div><div class="relatedPosts_item"><a href="/posts/58401/" title="Go 语言基础学习笔记"><img class="relatedPosts_cover" data-src="https://s2.loli.net/2022/09/10/vVYzpIRW4uwioGZ.png"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-29</div><div class="relatedPosts_title">Go 语言基础学习笔记</div></div></a></div><div class="relatedPosts_item"><a href="/posts/50862/" title="一点区块链"><img class="relatedPosts_cover" data-src="https://s2.loli.net/2022/09/10/s86OSoyDzRVqecH.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-05</div><div class="relatedPosts_title">一点区块链</div></div></a></div></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022  <i id="heartbeat" class="fa fas fa-heartbeat"></i> SimulatedSakura</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"><meta name="generator" content="Hexo 4.2.0"></head></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/calendar.js"></script><script src="/js/languages.js"></script></body></html>